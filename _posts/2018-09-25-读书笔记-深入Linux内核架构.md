---
layout: original
title: "读书笔记：深入Linux内核架构"
date: 2018-09-25 10:00:00 +0800 
categories: 读书笔记
tags: [摘录, 持续更新， 技术书籍]
---
* content
{:toc}


> 一本介绍Linux内核技术方面的书籍。讲的很细，读起来很爽。<br/>
> 以下只是机械性的摘录，读完某阶段后再单独总结。

<!-- more -->

## 第一章：简介和概述
### 内核的组成部分
* 进程和线程： 进程有独立的内存空间，线程依赖于进程的内存空间。
* 命名空间：Linux没有全局变量（比如PID等），而是有自己的集合  --> 很容易的创建Linux子系统（容器）
> 如`chroot`。`chroot`是一种简单形式的命名空间，可以将进程限制到文件系统的某一部分。
* 进程间通信通过内核实现，具体方法是内存空间有专门的内核空间。
* 内核线程：无权访问用户空间，负责数据同步、分配进程等。使用`ps`命令时，带`[]`的就是内核线程。有的内核线程必须在指定CPU上运行，`[/num]`表明在哪个CPU上运行。
* 页帧：物理内存页； 页：虚拟地址页。
* 页表：将虚拟地址空间映射到物理地址空间。通常采用多级页表来减少存储空间。
* 伙伴系统：一种内存分配方式，可以一定程度上减少内存碎片（为什么？）
* slab分配器：负责分配小内存以及提供一般性的内核缓存。
* 模块：一种在内核空间运行的程序，可以动态的向内核添加功能。
* 链表处理：内核标准双链表实现方式。
* 所有内核代码都必须是并发安全的。


## 第二章：进程管理和调度
* 进程生命周期：运行、 等待、 睡眠、 终止。
* 僵尸进程：其占有的资源已经释放，但在进程表中仍有相应的表项。（因为残余的数据很少，所以僵尸进程影响不大）
> 产生原因：进程已经被另一个进程或用户杀死，但进程的父进程没有向内核确认子进程的终结。

* 进程优先级： 中断 > 系统调用 > 普通进程
* 进程产生的两种方式：1. `fork`. 生成当前进程的一个副本。 2. `exec`. 加载一个新程序。

#### 命名空间
创建方式：
1. `fork`或`clone`时有特定的选项可以控制与父进程共享命名空间还是建立新的命名空间。
2. `unshare`命令。 该系统调用可以将进程的某些部分从父进程分离，包括命名空间。

##### 实现